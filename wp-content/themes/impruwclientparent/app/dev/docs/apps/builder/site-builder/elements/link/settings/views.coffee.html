<!DOCTYPE html>
<html>
<head>
  <title>views.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../../../../doc-style.css" />
  <script src="../../../../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../../../../", thisFile = "Applications/XAMPP/xamppfiles/htdocs/impruw/wp-content/themes/impruwclientparent/app/dev//apps/builder/site-builder/elements/link/settings/views.coffee", defaultSidebar = true;
  </script>
  <script src="../../../../../../doc-script.js"></script>
</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container"><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
          <h1>views.coffee</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1">&#182;</a>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre><span class="nx">define</span> <span class="p">[</span><span class="s">&#39;app&#39;</span><span class="p">,</span> <span class="s">&#39;text!apps/builder/site-builder/elements/link/settings/templates/settings.html&#39;</span><span class="p">],</span>
    <span class="nf">(App, settingsTpl)-&gt;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2">&#182;</a>
</div>
<p>Headerapp views</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="nx">App</span><span class="p">.</span><span class="nx">module</span> <span class="s">&#39;SiteBuilderApp.Element.Link.Settings.Views&#39;</span><span class="p">,</span> <span class="nf">(Views, App, Backbone, Marionette, $, _)-&gt;</span>

        <span class="k">class</span> <span class="nx">Views</span><span class="p">.</span><span class="nx">SettingsView</span> <span class="k">extends</span> <span class="nx">Marionette</span><span class="p">.</span><span class="nx">ItemView</span>

          <span class="nv">template : </span><span class="nx">settingsTpl</span>

          <span class="nv">className : </span><span class="s">&#39;modal-content settings-box&#39;</span>

          <span class="nx">initialize</span><span class="o">:</span><span class="nf">(opt = {})-&gt;</span>
            <span class="p">{</span><span class="nx">@eleModel</span><span class="p">}</span> <span class="o">=</span> <span class="nx">opt</span>
            <span class="k">super</span> <span class="nx">opt</span>

          <span class="nx">onRender</span><span class="o">:</span><span class="nf">-&gt;</span>
            <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;input[type=&quot;checkbox&quot;]&#39;</span><span class="p">).</span><span class="nx">checkbox</span><span class="p">()</span>
            <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;select&#39;</span><span class="p">).</span><span class="nx">selectpicker</span><span class="p">()</span>
            <span class="nx">@setFields</span><span class="p">()</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3">&#182;</a>
</div>
<p>set fields for the form</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="nx">setFields</span><span class="o">:</span><span class="nf">-&gt;</span>
            <span class="k">if</span> <span class="nx">@eleModel</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s">&#39;draggable&#39;</span><span class="p">)</span> <span class="o">is</span> <span class="kc">true</span>
              <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;input[name=&quot;draggable&quot;]&#39;</span><span class="p">).</span><span class="nx">checkbox</span> <span class="s">&#39;check&#39;</span>

            <span class="nx">_</span><span class="p">.</span><span class="nx">each</span> <span class="p">[</span><span class="s">&#39;link&#39;</span><span class="p">,</span><span class="s">&#39;text&#39;</span><span class="p">],</span> <span class="nf">(field,i)=&gt;</span>
              <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&quot;input[name=&#39;</span><span class="si">#{</span><span class="nx">field</span><span class="si">}</span><span class="s">&#39;]&quot;</span><span class="p">).</span><span class="nx">val</span> <span class="nx">@eleModel</span><span class="p">.</span><span class="nx">get</span> <span class="nx">field</span>

            <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;select[name=&quot;style&quot;]&#39;</span><span class="p">).</span><span class="nx">selectpicker</span> <span class="s">&#39;val&#39;</span><span class="p">,</span> <span class="nx">@eleModel</span><span class="p">.</span><span class="nx">get</span> <span class="s">&#39;style&#39;</span> 
          

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>events</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
          <span class="nv">events:</span>
            <span class="s">&#39;click .close-settings&#39;</span> <span class="o">:</span> <span class="nf">(evt)-&gt;</span> 
                      <span class="nx">evt</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>
                      <span class="nx">App</span><span class="p">.</span><span class="nx">settingsRegion</span><span class="p">.</span><span class="nx">close</span><span class="p">()</span>
            <span class="s">&#39;change input[name=&quot;draggable&quot;]&#39;</span><span class="o">:</span> <span class="nf">(evt)-&gt;</span> <span class="nx">@trigger</span> <span class="s">&quot;element:draggable:changed&quot;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="o">is</span><span class="p">(</span><span class="s">&#39;:checked&#39;</span><span class="p">)</span>
            <span class="s">&#39;change select[name=&quot;style&quot;]&#39;</span>   <span class="o">:</span><span class="nf">(evt)-&gt;</span> <span class="nx">@trigger</span> <span class="s">&quot;element:style:changed&quot;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
            <span class="s">&#39;blur input.linktext&#39;</span><span class="o">:</span><span class="nf">(evt)-&gt;</span> 
                <span class="nv">name = </span><span class="nx">$</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">attr</span> <span class="s">&#39;name&#39;</span>
                <span class="nx">@trigger</span> <span class="s">&quot;element:</span><span class="si">#{</span><span class="nx">name</span><span class="si">}</span><span class="s">:changed&quot;</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
            <span class="s">&#39;change input[name=&quot;target&quot;]&#39;</span><span class="o">:</span> <span class="nf">(evt)-&gt;</span> 
                <span class="nx">@trigger</span> <span class="s">&quot;element:target:changed&quot;</span><span class="p">,</span> <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">).</span><span class="o">is</span><span class="p">(</span><span class="s">&#39;:checked&#39;</span><span class="p">)</span> <span class="k">then</span> <span class="s">&#39;_BLANK&#39;</span> <span class="k">else</span> <span class="s">&#39;self&#39;</span>
          
          <span class="nx">onBeforeClose</span><span class="o">:</span><span class="nf">-&gt;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>trigger blur events so that the model gets updated</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="nx">@$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s">&#39;input.linktext&#39;</span><span class="p">).</span><span class="nx">trigger</span> <span class="s">&#39;blur&#39;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>this is important because this event is triggered to prevent the view from being closed
the view needs to be closed but just trigger the blur events so that the element view is
updated</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
            <span class="k">return</span> <span class="kc">true</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
