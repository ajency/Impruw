/**
 * Created by Nutan on 11/7/14.
 */

jQuery(document).ready(function(){

    // jQuery('.login-btn').popover({
    //     'placement': 'auto bottom',
    //     'html': true,
    //     'content': '<form id="frm_login" name="frm_login"><div class="form-group"><input type="email" class="form-control" id="InputEmail" placeholder="'+user_login_texts.placeholder_email+'"></div><div class="form-group"><button id="btn_login2" name="btn_login2" type="button" class="btn btn-xs btn-block aj-imp-submit">'+user_login_texts.btn_sign_in+'</button></div><div id="login_status_div"><span class="icon icon-warning"></span> <span id="login_status"></span></div></form>',
    //     'container': 'body'
    // });


    // jQuery('.login-btn').click(function(e){
        
    //     e.preventDefault();

    // }).on('shown.bs.popover', function () {
        
    //     jQuery('.popover').addClass('login-pop');

    // });

    jQuery('#InputEmail').live('keypress',function(evt){
    
        if ( evt.which === 13 ){
            evt.preventDefault();
            jQuery('#btn_login2').click() 
        }

    });

    jQuery('#btn_login2').live('click',function() {

        jQuery("#login_status_div").hide();
        jQuery("#login_status_div").addClass('hidden');

        var data = {
            action: 'user_interim_login',
            pdemail: jQuery('#InputEmail').val()
        };

        jQuery.post(ajaxurl, data, function(response) {

            if (response.code == 'OK') {
                window.location.href = response.blog_url + '/sign-in?email='+response.email;
                return true;
            } else if ((response.code == 'FAILED' || response.code == 'ERROR')) {

                jQuery("#login_status_div").show();
                jQuery("#login_status_div").removeClass('hidden');
                jQuery("#login_status").html(response.msg);

                return false;
            }
        });


    });

    // jQuery('select').selectpicker();
});
